function initAccordion(){$(".restaurants__bottom").on("click",function(){$(".restaurants__item.active").find(".restaurants__bg").slideToggle("slow"),$(".restaurants__item").removeClass("active"),$(this).closest(".restaurants__item").addClass("active"),$(this).closest(".restaurants__item.active").find(".restaurants__bg").slideToggle("slow")})}
function initAnimation(){document.querySelectorAll(".js-staged-container").forEach(function($container){var $els=$container.querySelectorAll(".js-staged"),stringObj=$container.dataset.opts,opts=(eval("var obj="+stringObj),{}),key;for(key in obj)opts[key]=obj[key];opts.delay||(opts.delay=.3),opts.opacity||(opts.opacity=0),opts.stagger||(opts.stagger=.3),opts.scale||(opts.scale=0),opts.duration||(opts.duration=.8),opts.ease||(opts.ease="power1.inOut");var t=gsap.from($els,opts),controller=new ScrollMagic.Controller;new ScrollMagic.Scene({triggerElement:$container,triggerHook:.7}).setTween(t).addTo(controller)});var controller=new ScrollMagic.Controller,scene,scene;$(".js-parallax-text").length&&(scene=new ScrollMagic.Scene({triggerHook:1,triggerElement:".js-parallax-text",duration:1800}).setTween(".js-parallax-text",{y:-150,ease:"power1.inOut",stagger:.1}).addTo(controller),scene=new ScrollMagic.Scene({triggerHook:1,triggerElement:".js-parallax-text-2",duration:1800}).setTween(".js-parallax-text-2",{y:-150,ease:"power1.inOut",stagger:.1}).addTo(controller)),window.screen.width}
function burger(){$(".js-burger").on("click",function(){$(this).hasClass("active")?(scrollLock.enablePageScroll(),scrollLock.clearQueueScrollLocks(),scrollLock.getScrollState()):scrollLock.disablePageScroll(),$(this).toggleClass("active"),$(this).closest(".header__mobile").toggleClass("open"),$(this).closest(".header__mobile").find(".header__opened-container").fadeToggle()})}
function daterangepickerSettings(){let t=$(".js-inputs"),n=$(".js-custom-calendar"),s=$(".js-main-calendar"),e=new Date;e.setDate(e.getDate()+364),t.dateRangePicker({autoClose:!1,format:"DD.MM.YYYY",separator:"-",language:"ru",startOfWeek:"monday",startDate:new Date,endDate:e,showShortcuts:!1,customShortcuts:[],inline:!1,container:"body",alwaysOpen:!1,singleDate:!1,lookBehind:!1,duration:200,customOpenAnimation:function(t){$(this).fadeIn(300,t)},customCloseAnimation:function(t){$(this).fadeOut(300,t)},beforeShowDay:function(t){t=String(t.getDate()).padStart(2,"0")+"."+String(t.getMonth()+1).padStart(2,"0")+"."+t.getFullYear();let e=!0,a="date-green";var n=e?"":"Нет свободных номеров";return console.log(disabledDate),console.log(t),console.log(),inObject(disabledDate,t)&&(e=!1,a="day-disabled",console.log("disabled")),[e,a,n]},stickyMonths:!0,dayDivAttrs:[],dayTdAttrs:[],customArrowPrevSymbol:'<span class="reservation-calendar__prev-arrow"></span>',customArrowNextSymbol:'<span class="reservation-calendar__next-arrow"></span>',applyBtnClass:"",singleMonth:"auto",showDateFilter:function(e,a){let t=new Date(e);e=String(t.getDate()).padStart(2,"0")+"."+String(t.getMonth()+1).padStart(2,"0")+"."+t.getFullYear();if(datesPrices[e]){let t="";return'<div class="div-date">\t\t\t\t\t<span class="span-date">'+a+'</span>\t\t\t\t\t<div class="div-price" style=" '+(t=0!=datesPrices[e].IS_SALE?"color: red;":t)+'">от '+datesPrices[e].PRICE+" ₽</div>\t\t\t\t</div>"}return'<div class="div-date">\t\t\t\t\t<span class="span-date">'+a+"</span>\t\t\t\t</div>"},showTopbar:!1,swapTime:!1,selectForward:!0,showWeekNumbers:!1,getWeekNumber:function(t){return moment(t).format("w")},monthSelect:!1,yearSelect:!1,getValue:function(){return n.val()&&s.val()?n.val()+" to "+s.val():""},setValue:function(t,e,a){n.val(e).addClass("focused"),s.val(a).addClass("focused")}})}function inObject(e,a){return 0<Object.keys(e).filter(function(t){return e[t]===a}).length}
function forms(){function n(n){""===n.val()?n.removeClass("focused"):n.addClass("focused")}$(".js-contacts-form").on("submit",function(n){n.preventDefault();var e,i=$(this).serializeObject(),t=!0;for(e in i)""===i[e]&&(t=!1,$(this).find("input[name="+e+"]").addClass("error"),window.screen.width<992&&$(this).find("input[name="+e+"]").closest(".contacts__input-container").css("margin-bottom","28px"),$(this).find("input[name="+e+"]").closest(".contacts__input-container").find(".message-error").text("Поле обязательно для заполнения").fadeIn());const a=$(this);t&&SendAjax("SEND_FORM",i,function(n){n&&(a.fadeOut("400"),setTimeout(function(){a.siblings(".contacts__success").fadeIn()},400))})}),$(".js-validate-form input, .js-validate-form textarea").on("input, change",function(){n($(this))}),$(".js-validate-form input").on("input, change",function(){var n,e;n=$(this),e=".contacts__input-container, .reservation__input-container",n.hasClass("error")&&(n.removeClass("error"),n.closest(e).find(".message-error").fadeOut(),window.screen.width<992&&n.closest(e).removeAttr("style"))}),$(".js-reservation-form-step-1").on("submit",function(n){if(n.preventDefault(),0<$(".js-custom-calendar.error").length)return!1;var e,i=$(this).serializeObject(),t=!0;for(e in i)if(""===i[e]){t=!1,$(this).find("input[name="+e+"]").addClass("error"),$(this).find("input[name="+e+"]").closest(".main__input-container").find(".message-error").text("Поле обязательно для заполнения").fadeIn(),window.screen.width<992&&($(this).find("input[name="+e+"]").siblings(".main__date-label").css("color","#D77846"),$(this).find("input[name="+e+"]").closest(".main__input-container").addClass("error"));const a=$(this);setTimeout(function(n){return function(){a.find("input[name="+n+"]").removeClass("error"),a.find("input[name="+n+"]").closest(".main__input-container").find(".message-error").fadeOut(),window.screen.width<992&&(a.find("input[name="+n+"]").siblings(".main__date-label").removeAttr("style"),a.find("input[name="+n+"]").closest(".main__input-container").removeClass("error"))}}(e),3e3)}t&&SendAjax("GET_DATES",i,function(n){n.NOT_FOUND?$(".js-not-found").html(n.NOT_FOUND):window.location.href=window.location.origin+"/reservation/?step=2"})}),$(".js-reservation-form-step-2").on("submit",function(n){n.preventDefault(),$(n.originalEvent.submitter).closest(".reservation__item").find("input[type=radio]").click();n=$(this).serializeObject();SendAjax("CHECKED_HOUSE",n,function(n){n&&(window.location.href=window.location.origin+window.location.pathname+"?step=3")})}),$(".js-reservation-form-step-3").on("submit",function(n){n.preventDefault();var e,i=$(this).serializeObject(),t=!0;for(e in i)""===i[e]&&-1==e.indexOf("MIDDLE_NAME")&&"COMMENTS"!==e&&(t=!1,$(this).find("input[name="+e+"]").addClass("error"),$(this).find("input[name="+e+"]").closest(".reservation__input-container").find(".message-error").text("Поле обязательно для заполнения").fadeIn());t&&SendAjax("ORDER",i,function(n){console.log(n),"finish"!==n.STATUS?window.location.href=window.location.origin+"/yoomoney/pay.php?id="+n.ID:window.location.href=window.location.origin+"/yoomoney/success.php?id="+n.ID})}),$("#firstName, #middleName, #lastName").on("keyup",function(){$("#anotherMan").is(":checked")||($("#"+$(this).attr("id")+"_0").val($(this).val()).trigger("change"),n($("#"+$(this).attr("id")+"_0")))}),$("#anotherMan").on("click",function(){$(this).is(":checked")?$("#lastName_0, #middleName_0, #firstName_0").val("").removeClass("focused"):($("#lastName_0").val($("#lastName").val()).trigger("change"),$("#middleName_0").val($("#middleName").val()).trigger("change"),$("#firstName_0").val($("#firstName").val()).trigger("change"))})}
function sendYandexGoal(a){yaCounter37696905.reachGoal(a),ga("send","pageview","/"+a+".html")}function myValidateForm(i){i.find(".req");i.find(".req").removeClass("error");var d=!0;return i.find(".req").each(function(a,e){var r,n,t=$(e);""==t.val()&&($(e).addClass("error"),d=!1),"checkbox"==t.attr("type")&&0==t.prop("checked")&&($(e).addClass("error"),d=!1),"EMAIL"===t.attr("name")&&""===t.val()||"EMAIL"!==t.attr("name")||isValidEmailAddress(t.val())||($(e).addClass("error"),d=!1),"PASSWORD"===t.attr("name")&&(r=!1,(r=""!==t.val()&&t.val().length<6?!0:r)&&($(e).addClass("error"),d=!1)),"CONFIRM_PASSWORD"===t.attr("name")&&(r=!1,n=i.find(".req[name=PASSWORD]"),(r=""!==t.val()&&t.val()!==n.val()?!0:r)&&($(e).addClass("error"),d=!1))}),d}function SendAjax(a,e,r){r=r||function(){},$.ajax({url:"/ajax.php",dataType:"json",type:"POST",data:{action:a,data:e},error:function(a){console.log(a)}}).done(function(a){r(a)})}function isValidEmailAddress(a){return new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(a)}$.fn.serializeObject=function(){var t=this,i={},e={},d={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(a,e,r){return a[e]=r,a},this.push_counter=function(a){return void 0===e[a]&&(e[a]=0),e[a]++},$.each($(this).serializeArray(),function(){if(d.validate.test(this.name)){for(var a,e=this.name.match(d.key),r=this.value,n=this.name;void 0!==(a=e.pop());)n=n.replace(new RegExp("\\["+a+"\\]$"),""),a.match(d.push)?r=t.build([],t.push_counter(n),r):a.match(d.fixed)?r=t.build([],a,r):a.match(d.named)&&(r=t.build({},a,r));i=$.extend(!0,i,r)}}),i};
function initHeader(){var i=window.screen.width<=991?$(".js-header-mobile"):$(".js-header"),s=$(window).scrollTop(),a=(calcHeader(s,i,a),s);$(window).on("scroll",function(e){calcHeader(s=$(window).scrollTop(),i,a),a=s})}function calcHeader(e,i,s){if(e<=window.screen.height&&991<window.screen.width)return i.removeClass("active"),i.addClass("hide"),!1;i.removeClass("hide"),i.addClass("active")}jQuery.event.special.touchstart={setup:function(e,i,s){this.addEventListener("touchstart",s,{passive:!0})}};
function height(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")}
function loader(){var o=!1,e=!1;$(window).on("load",function(){o=!0,e&&$(".preloader").fadeOut(3e3)}),$(".js-preloader-logo").on("animationend",function(){e=!0,o&&$(".preloader").fadeOut(3e3)})}
function modal(){$("a[data-modal]").on("click",function(a){a.preventDefault();var a=$(this).data("id"),n=$(this).attr("href"),t=$(this).data("type"),e=$(this).data("modal-id");e&&SendAjax("OPEN_MODAL",{ID:a,TYPE:t,MODAL_ID:e},function(a){function t(a){a.namespace&&(a=a.relatedTarget).$element.siblings(".about__slider-controls").find(".about__counter").html("<span> "+(Number(a._current)+1)+"</span>/"+a.items().length)}a&&($(".js-replace-modal").html(a),$(".js-modal-slider").owlCarousel({items:1,loop:!1,center:!1,margin:6,autoWidth:!1,nav:!0,dots:!1,smartSpeed:700,lazyLoad:!0,navText:["<span></span>","<span></span>"],navContainer:$(".js-modal-controls"),onInitialized:t,onChanged:t}),$(n).modal({fadeDuration:700,fadeDelay:.5}))})})}
function other(){$("input[name=PHONE]").mask("+7(999)-999-99-99"),$(".js-select-dropdown").on("click",function(){$(this).addClass("active"),$(this).find(".main__select-dropdown").fadeIn()}),$(document).click(function(t){!$(t.target).closest(".js-select-dropdown").length&&$(".js-select-dropdown").hasClass("active")&&$(this).find(".main__select-dropdown").fadeOut()}),$(".js-down-count").on("click",function(){var t=$(this).closest(".main__select-controls").find(".main__select-quantity"),e=$(this).closest(".main__select-controls").find(".main__select-quantity-label"),s=$(this).closest(".js-select-dropdown").find("span.quantity"),o=[],o="CHILD"===t.attr("name")?["0","1"]:["1","2"];return t.val()!==o[0]&&(t.val()===o[1]&&($(this).addClass("disabled"),e.addClass("disabled")),"0"!==t.text()&&(t.val(Number(t.val())-1),e.text(Number(e.text())-1),void($(this).closest(".main__select-controls").data("child")||s.text(Number(t.val())))))}),$(".js-up-count").on("click",function(){var t=$(this).closest(".main__select-controls").find(".main__select-quantity"),e=$(this).closest(".main__select-controls").find(".main__select-quantity-label"),s=$(this).closest(".main__select-controls").find(".js-down-count"),o=$(this).closest(".js-select-dropdown").find("span.quantity"),n="",n="CHILD"===t.attr("name")?"0":"1";t.val()===n&&(s.removeClass("disabled"),e.removeClass("disabled")),t.val(Number(t.val())+1),e.text(Number(e.text())+1),$(this).closest(".main__select-controls").data("child")||o.text(Number(t.val()))});const t=lozad(".lozad",{threshold:.1,enableAutoReload:!0});t.observe(),991<window.screen.width&&new Sticky(".js-sticky"),$(".js-price-button").on("click",function(){$(this).toggleClass("active"),$(this).siblings(".js-list-content").slideToggle(300)}),window.screen.width<991&&0<$(".breadcrumbs__step.active").length&&$(".js-scroll-left").animate({scrollLeft:$(".breadcrumbs__step.active").position().left},1500),$(".js-copy").on("click",function(){var t=$("<input>");$("body").append(t),t.val($(this).text()).select(),document.execCommand("copy"),t.remove(),$(this).addClass("copied"),self=$(this),setTimeout(function(){self.removeClass("copied")},7e3)}),$("body").on("click",'[href="/reservation/"]',function(t){t.preventDefault(),$("#custom-modal-error").modal(),$(".jquery-modal").addClass("no-before"),$(window).width()<992&&$("#custom-modal-error").removeClass("modal"),console.log("без брони")})}
function scrollLink(){$(document).on("click",".js-menu-link",function(n){n.preventDefault(),window.screen.width<=576&&$(".js-burger").click(),$("html, body").animate({scrollTop:$($(this).attr("href")).offset().top},1e3,"linear")})}function zoomOnScroll(){991<window.screen.width&&$(document).on("scroll",function(n){if($("body").hasClass("js-burger"))return n.preventDefault(),!1;$(this).scrollTop()<=700&&$(".main__bg").css("transform","translate(-50%,-50%) scale("+(1.2-$(this).scrollTop()/3500)+")")})}
function initSlider(){for(var e=$(".js-slider-about"),n=$(".js-slider-controls"),t=($(".about__dots"),0);t<e.length;t++)$(e[t]).owlCarousel({items:1,loop:!1,center:!1,margin:6,autoWidth:!1,nav:!0,dots:!1,smartSpeed:700,lazyLoad:!0,navText:["<span></span>","<span></span>"],navContainer:$(n[t]),onInitialized:a,onChanged:a});function a(e){e.namespace&&(e=e.relatedTarget).$element.siblings(".about__slider-controls").find(".about__counter").html("<span> "+(Number(e._current)+1)+"</span>/"+e.items().length)}$(".js-reservation-slider").owlCarousel({items:1,loop:!1,center:!1,margin:6,autoWidth:!1,dots:!0,smartSpeed:700})}
$(document).ready(function(){initSlider(),initAccordion(),scrollLink(),zoomOnScroll(),burger(),height(),other(),0<$("[data-has-calendar='y']").length&&daterangepickerSettings(),initAnimation(),initHeader(),forms(),modal()}),loader();